[build]
  command = "npm run build"
  publish = "dist"

[functions]
  directory = "netlify/functions"

[[blobs]]
  name = "mp_tokens"

# ðŸš€ Scheduler para recordatorios (cada 15 minutos)
[functions."recordatorios"]
  schedule = "*/15 * * * *"

# ðŸ•’ Scheduler para actualizar dÃ­as de prueba (1 vez al dÃ­a)
[functions."actualizar-trials"]
  schedule = "0 6 * * *" # todos los dÃ­as a las 06:00 UTC aprox

# ----------------------------
# âœ… Rutas protegidas de la app
# ----------------------------

[[redirects]]
  from = "/agenda/*"
  to = "/agenda/:splat"
  status = 200

[[redirects]]
  from = "/panel/*"
  to = "/panel/:splat"
  status = 200

[[redirects]]
  from = "/admin/*"
  to = "/admin/:splat"
  status = 200

[[redirects]]
  from = "/login"
  to = "/login"
  status = 200

[[redirects]]
  from = "/api/*"
  to = "/api/:splat"
  status = 200

[[redirects]]
  from = "/.netlify/*"
  to = "/.netlify/:splat"
  status = 200

# âœ… URL corta para agendas: /a/slug => /agenda/slug
[[redirects]]
  from = "/a/:slug"
  to = "/agenda/:slug"
  status = 301
  force = true

# âœ… SPA fallback
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200