[build]
  command = "npm run build"
  publish = "dist"

[functions]
  directory = "netlify/functions"

[[blobs]]
  name = "mp_tokens"

# ðŸš€ Scheduler para recordatorios (cada 15 minutos)
[functions."recordatorios"]
  schedule = "*/15 * * * *"

# ðŸ•’ Scheduler para actualizar dÃ­as de prueba (1 vez al dÃ­a)
[functions."actualizar-trials"]
  schedule = "0 6 * * *" # todos los dÃ­as a las 06:00 UTC aprox

# ----------------------------
# âœ… Mantener agenda funcionando SIN tocar el frontend
# /slug  -> /agenda/slug  (redirige)
# ----------------------------

# âš ï¸ Primero, NO toques rutas reales de tu app
[[redirects]]
  from = "/agenda/*"
  to = "/agenda/:splat"
  status = 200

[[redirects]]
  from = "/panel/*"
  to = "/panel/:splat"
  status = 200

[[redirects]]
  from = "/admin/*"
  to = "/admin/:splat"
  status = 200

[[redirects]]
  from = "/login"
  to = "/login"
  status = 200

[[redirects]]
  from = "/api/*"
  to = "/api/:splat"
  status = 200

[[redirects]]
  from = "/.netlify/*"
  to = "/.netlify/:splat"
  status = 200

# âœ… PÃ¡ginas estÃ¡ticas (excluidas del redirect a /agenda/)
[[redirects]]
  from = "/politica-cookies"
  to = "/politica-cookies"
  status = 200

# âœ… AHORA SÃ: /slug => /agenda/slug (cambia la URL)
[[redirects]]
  from = "/:slug"
  to = "/agenda/:slug"
  status = 301
  force = true

# âœ… SPA fallback (Vite): cualquier ruta carga la app
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200